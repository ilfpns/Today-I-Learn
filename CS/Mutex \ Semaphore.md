> **before ..**
> 

---

프로세스 간 메시지를 전송하거나, 공유 메모리를 통해 공유된 자원에 여러 개의 프로세스가 동시에 접근하면 `Critical Section` 문제가 발생할 수 있다

⇒ 이를 해결하기 위해 데이터를 한 번에 하나의 프로세스만 접근할 수 있도록 제한을 두는 `동기화 방식`을 취해야 한다 

1. 뮤텍스 / Mutex
2. 세마포어 / Semaphore

대표적 동기화 도구 2가지로 

이들은 모두 공유된 자원의 데이터를 여러 스레드/프로세스가 접근하는 것을 막는 역할을 한다

> **Critical Section / 임계 영역**
> 

---

⇒ 여러 프로세스가 데이터를 공유하며 수행될 때, 각 프로세스에서 공유 데이터를 접근하는 프로그램 코드 블록

즉, 여러 프로세스가 동일 자원을 동시에 참조하여 값이 오렴될 위험이 있는 영역

→ 프로그래밍을 할 때 임계 영역을 최소화 하여 설계해야 한다

> **Mutex**
> 

---

⇒ 동시 프로그래밍에서 공유 불가능한 자원의 동시 사용을 피하기 위해 사용하는 알고리즘

- 임계 구역 (Critical Section)을 가진 스레드들의 실행 시간이 서로 겹치지 않고 각각 단독으로 실행 (상호 배제 : Mutual Exclution)되도록 하는 기술

- 한 프로세스에 의해 소유될 수 있는 Key를 기반으로 한 상호배제 기법
    - Key에 해당하는 어떤 객체 (Object)가 있으며, 이 객체를 소유한 스레드 / 프로세스만이 공유 자원에 접근할 수 있다
    
- 다중 프로세스들의 공유 리소스에 대한 접근을 조율하기 위해 동기화 (Sync) 또는 락 (Lock)을 사용

- 뮤텍스 객체를 두 스레드가 동시에 사용할 수 없다

<img width="880" height="290" alt="image" src="https://github.com/user-attachments/assets/0d78ddf0-932f-40de-b2ce-bffc4dd9a1b5" />

> **Semaphore**
> 

---

⇒ 멀티 프로그래밍 환경에서 공유된 자원에 대한 접근을 제한하는 방법 

- 공유자원의 상태를 나타낼 수 있는 `카운터` 로 생각할 때
    - 사용하고 있는 스레드 / 프로세스의 수를 공통으로 관리하는 하나의 값을 이용해 상호배제를 달성한다
    - 운영체제 또는 커널의 한 지정된 저장장치 내의 값
    - 일반적으로 비교적 긴 시간을 확보하는 리소스에 대한 이용
    - 유닉스 프로그래밍에서 세마포어는 운영체제의 리소스를 경쟁적으로 사용하는 다중 프로세스에서 행동을 조정하거나 또는 동기화하는 기술

- 공유된 자원에 접근할 수 있는 프로세스의 최대 허용치만큼 동시에 사용자가 접근할 수 있다

- 각 프로세스는 세마포어의 값을 확인하고 변경할 수 있다

- 자원을 사용하지 않는 상태가 될 때, 대기하던 프로세스가 즉시 자원을 사용한다

- 이미 다른 프로세스에 의해 사용중이라는 사실을 알게 되면, 재시도 전에 일정 시간 대기해야 한다

- 세마포어를 사용하는 프로세스는 그 값을 확인하고, 자원을 사용하는 동안에는 그 값을 변경함으로써 다른 세마포어 사용자들이 대기하도록 해야 한다

- 세마포어는 이진수를 사용하거나 추가적인 값을 가질 수 있다

<img width="879" height="539" alt="image" src="https://github.com/user-attachments/assets/37e44e46-bfbc-4ceb-92cb-08cdb41cc9c0" />

> **Mutex 와 Semaphore**
> 

---

## 차이점

1. 가장 큰 차이점으로 `동기화 대상의 갯수` 이다
    - Mutex는 동기화 대상이 only 1개일 때 사용
    - Semaphore는 동기화 대상이 1개 이상일 때 사용
    
2. `Semaphore`는 `Mutex`가 될 수 있다
    - Mutex는 0, 1 로 이뤄진 이진 상태를 가지므로 Binary Semaphore이다
    
3. Mutex는 `자원 소유 가능 + 책임`을 가진다, Somaphore는 `자원 소유가 불가`하다
    - 뮤텍스는 상태 0, 1 뿐이므로 Lock 가질 수 있음
    
4. Mutex는 `소유하고 있는 스레드만이` 이 Mutex를 해제할 수 있음
    - Semaphore는 Semaphore를 소유하지 않는 스레드가 해제할 수 있다

1. Semaphore는 시스템 범위에 걸쳐 있고, 파일 시스템 상의 파일로 존재한다
    - Mutex는 프로세스의 범위를 가지며 프로세스가 종료될 때 자동으로 Clean up 된다

### 참고

Mutex와 Semaphore는 모두 완벽한 기법으로 아니므로, 데이터 무결성을 보장할 수 없으며 모든 교착 상태를 해결하지는 못 한다

하지만, 상호배제를 위한 기본적 기법으로 여기에 좀 더 복잡한 매커니즘을 적용해 개선된 성능을 가질 수 있도록 하는 것이 중료하다
